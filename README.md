# PressureAdvanceTestPostscript
Постскрипт для подбора правильного pressure advance (linear advance)

Данный скрипт предназначен для обработки g-code, сгенерированного слайсером. Суть обработки в расстановке  разных коэффициентов pressure advance по копиям объектов, с целью определения лучшего коэффициента для конкретного принтера и филамента.
В комплекте представлены файлы 3mf с подготовленными моделями для слайсеров PrusaSlicer и QIDISlicer. Хотя QIDISlicer и основан на PrusaSlicer, обратной совместимости у них нет.
Проект представляет из себя набор кубиков (по умолчанию 20), подготовленных для теста. Печатается три слоя сплошных, а затем стенки в два периметра. Такой формат позволяет довольно точно подобрать PA, поскольку показывает сразу несколько возможных дефектов - внешние углы, образование дырок в периметрах на углах и наплывы на верхнем слое.

## Подготовка файла g-code для обработки скриптом
Откройте проект в слайсере. Выберите свой принтер, филамент и настройки печати. Выполните нарезку модели и экспортируйте код в файл. 
Запустите скрипт, укажите файл, задайте старовый и конечный PA и выполните обработку. Для проверки можете открыть полученный файл в просмотрщике g-code, например в Prusa G-Code Viewer.
Загрузите полученный файл на принтер и напечатайте.

## Особенности работы скрипта:
Выходной файл генерируется в каталог output, если вы просто скопировали скрипт - позаботьтесь, чтобы он был в той же папке, где и скрипт
Консольная версия скрипта ищет файлы в каталоге input

Формат имени выходного файла - PA_Test_{количество кубиков}pcs_{стартовый PA}-{конечный PA}_{тип филамента}_{температура}.gcode

Для корректной обработки есть три требования
* в настройках печати в разделе "Выходные параметры" должен быть включен параметр "Подробный G-код"
* там же параметр "Название моделей" необходимо установить в значение "Зависит от прошивки"
* в настройках принтера должно быть установлено "Использовать относительные координаты для экструдера (Е)"
Поскольку диапазон PA задается вручную и равномерно распределяется на количество кубиков - получаемый шаг может содержать много цифр после точки. Но он округляется и последний коэффициент в полученном ряду может сильно отличаться от заданного конечного. Учтите этот момент и просматривайте список генерируемых значений.

## Пример сгенерированного файла

![image](https://github.com/user-attachments/assets/6acffdad-f4d7-464c-a074-96d842665527)

# Требования

Скрипт представлен в двух вариантах - как есть и в виде исполняемого exe файла, собранного с помощью pyinstaller.

Для разработки использовался Python 3.13, возможно будет работать и на версиях ниже, не проверял.

Версия c GUI сделана с использованием PySimpleGUI, который требует лицензии. Для личного использования лицензия бесплатна сроком на год, продление тоже бесплатно. Но все это требует времени на регистрацию на сайте PySimpleGUI и возможны дальнейшие изменения.

Поэтому собран и простой консольный exe-файл с той же функциональностью.
